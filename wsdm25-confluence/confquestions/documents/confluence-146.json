{
    "id": "confluence-146",
    "title": "Xen 4.6 Uprev - Patch queue",
    "url": "https://openxt.atlassian.net/wiki/spaces/DC/pages/38338598/Xen+4.6+Uprev+-+Patch+queue",
    "content": "<p>Owned by Ross Philipson\nLast updated: Jul 28, 2016 by Machon Gregory\n\n</p><ac:layout><ac:layout-section ac:type=\"single\"><ac:layout-cell><p>Xen Patch Enumeration</p><p>States:</p><p>applied - Patch functionality is already contained in Xen version 4.6</p><p>applies - Patch applies cleanly to Xen 4.6</p><p>does-not-apply - Patch does not apply to Xen 4.6</p><p>Decisions:</p><p><span style=\"color: rgb(0,0,0);\">K - Keep</span></p><p>D - Drop</p><p>R - Refactor</p><p>U - Upstream</p><p> </p><table class=\"wrapped\"><colgroup><col style=\"width: 384.0px;\"/><col style=\"width: 84.0px;\"/><col style=\"width: 116.0px;\"/><col style=\"width: 386.0px;\"/><col style=\"width: 82.0px;\"/><col style=\"width: 754.0px;\"/></colgroup><tbody><tr><th>Patch Name</th><th>Sub Systems</th><th>State</th><th>Upstream Commit</th><th colspan=\"1\">Decision</th><th>Comments</th></tr><tr><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">config.patch</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">build</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">R: I moved these first 3 patches here when I messed with the blktap patches. I believe they are all valid.</td></tr><tr><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">do-not-overwrite-cc-and-ld.patch</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"><span>build</span></td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">ditto</td></tr><tr><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"><p>disable-xen-root-check.patch</p></td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"><span>build</span></td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" data-highlight-colour=\"yellow\">ditto</td></tr><tr><td colspan=\"1\">bp-ept-update-aa9114edd97b292cd89b3616e3f2089471fd220.patch</td><td colspan=\"1\"><p>xen</p></td><td colspan=\"1\">applied</td><td colspan=\"1\">226bc8ee4e0fd26bd3cbdb533eb447fdcd7a90bf</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">fix-xenctrl-enum-defn.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">31d2d1e08a0a7334d031c6a8ae98d0942f9e6362</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xen-cpuidle-hang.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p> </p></td></tr><tr><td colspan=\"1\">sb_reboot_turbo_workaround.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: This is definitely something from XCE. The SDM has very little to say about this MSR other than \"See <a href=\"http://biosbits.org\">http://biosbits.org</a>.\". Looks like it is somethign on the Nehalem CPUs:</p><p><a href=\"https://chromium.googlesource.com/chromiumos/third_party/coreboot/+/master/util/msrtool/intel_nehalem.c\">https://chromium.googlesource.com/</a></p><p><a href=\"https://chromium.googlesource.com/chromiumos/third_party/coreboot/+/master/util/msrtool/intel_nehalem.c\">chromiumos/third_party/coreboot/+/master/util/msrtool/intel_nehalem.c</a></p><p>I don't know what to do with it, flip a coin maybe...</p></td></tr><tr><td colspan=\"1\">tapdisk_shutdown_recursion.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>E: tapdisk is currently built from its own forked repository. So those patches would belong in that repo if anywhere. Also moving to blktap3 will probably take care of the tapdisk patches.</p><p>R: See my comments on <span>blktap-resume-fix.patch though since we don't know what the original issue was it could be argued that this is just cargo and should go.</span></p><p><span>R: After further consideration we think this is some sort of workaround that never had enything to do with XT. We aren't even using it now so...drop.</span></p></td></tr><tr><td colspan=\"1\">xen-allow-hvm.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">d640a290f281704d8375ef388da53dbca9c1d248</td><td colspan=\"1\">D</td><td colspan=\"1\">E: Isn't this upstream already? M: Yes</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">blktap-resume-fix.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>is this affected by the move to blktap3</p><p>E: blktap has its own repository in OpenXT.</p><p>R: well that could change since I rebased on blktap2 in Xen and blktap3 could be a ways off. I went through all the blktap related patches in this patch queue and threw out most of them. The ones I kepts seemed to make sense to me.</p></td></tr><tr><td colspan=\"1\">rmrr-validate-range.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">92181f18298ff8c415354150414efb7195c1b620</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xentrace-format-handle-zero-tsc.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">U</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>E: Could be posted upstream?</p><p>R: Yea it looks valid, we can try to upstream.</p><p>M: <ac:structured-macro ac:macro-id=\"ad8314be-943b-4e9d-808f-081ac7c5a1a3\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-577</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">iobitmap-on-all-vcpus.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: This is an XCE one, saw the origninal commit message. It was to fix some NVIDIA issue they had. The Xen part read: \"Fix SMP issue, where the ioport mask was not propagated to all VCPUS.\" which is exactly what the patch does. I am inclined to drop it but I will let others chime in.</p><p>R: This is very specific to a customer issue XCE had. If this were a general problem then nothing would work. Eric and I vote to drop.</p></td></tr><tr><td colspan=\"1\">fix-32bit-xsm-interface.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">374900d9f3c5d1596b27a6ec29014c9981be0714</td><td colspan=\"1\">D</td><td colspan=\"1\">a later commit (31d2d1e08a0a7334d031c6a8ae98d0942f9e6362) moves xenctl.h. covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">fix-pci-serial-hang.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">37f36d894ef43dc2986d0936612ec967c5a89be8</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xsm-add-corespersocket.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>functionality required for xc-xt-aperture-map.patch</p><p>E: xc-xt-aperture-map.patch can be removed.</p><p>M: Also needed for xc-xt-cpuid.patch</p></td></tr><tr><td colspan=\"1\">incremental-dmesg-processing.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>removing checks in conditionals seems broken</p><p>R: Yea that looks wrong to me too. Not originally one of ours, I would remove it.</p></td></tr><tr><td colspan=\"1\">add-percentages-to-xenpm.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: Debug instrumentation, can be ignored.</p><p>R: Definitely we don't even use xenpm</p></td></tr><tr><td colspan=\"1\">stack_on_triple_fault.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: Debug instrumentation, can be ignored.</p><p>R: I agree on all the instrumentation patches, leave them out.</p></td></tr><tr><td colspan=\"1\">hvmloader_print_e820.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: Debug instrumentation, can be ignored.</p></td></tr><tr><td colspan=\"1\">microcode-info.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: Debug instrumentation, can be ignored.</p></td></tr><tr><td colspan=\"1\">add_system_time_timestamps.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: Debug instrumentation, can be ignored.</p></td></tr><tr><td colspan=\"1\">local-ipxe.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>specifies usage of open source ipxe code</p><p>E: Can be ignored, OpenXT builds ipxe in its separate repository.</p></td></tr><tr><td colspan=\"1\">10ms_timeslice.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>changes default timeslice to 10ms (why?)</p><p>E: Yes, why?</p><p>R: Checked our pre XCE pq and it is not there, probably added by XCE, I would leave it out.</p><p>X: Was it related to providing support for audio?</p><p>R: I have no idea. I see the original two commits but there is nothing informative in the comments. It was clearly an XCE thing that predated our common XT/XCE patch queue.</p></td></tr><tr><td colspan=\"1\">publish_xentrace_formats.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>why is this published</p><p>E: No idea, it can probably be ignored.</p><p>R: I think it can be ignored too.</p></td></tr><tr><td colspan=\"1\">add-command-line-option-to-disable-arat.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>is the command line option ever used?</p><p>E: This is likely related to AMD CPUs which were affected by erratum 400 (<a href=\"http://support.amd.com/TechDocs/41322_10h_Rev_Gd.pdf\">http://support.amd.com/TechDocs/41322_10h_Rev_Gd.pdf</a> ?)</p><p>R: The option is never used in OpenXT, I say drop it.</p></td></tr><tr><td colspan=\"1\">hotplug-scripts-iptables.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>structure of the script has changed completely. where is the DMD that allows this functionality to be commented out</p><p>E: This script is not used in OpenXT afaict.</p><p>R: And this was not our patch in the first place. I say nuke it.</p></td></tr><tr><td colspan=\"1\">hvm-pm-s-states.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>adds hypercall to emulates PIIX4 (82371AB) Suspend and Resume Logic (Power On Suspend) (some of the patched header files no longer exist)</p><p>R: That one is not in our original PQ either, may be an XCE thing. I don't see anything using that HVM op anywhere in our code. I think it can go.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">hvm-pm-hibernate-s-state.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>adds power states</p><p>R: We support guest S4 so I think this one should stay.</p></td></tr><tr><td colspan=\"1\">prune-acpi-devices.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>removes speaker and floppy drive from qemu device model (why?)</p><p>E: Removes ASL descriptions in the DSDT passed to HVMLoader only. I have no memory of this and I seem to recall it was not part of former XenClientXT Xen 4.1 patch-queue. Also I would recommend to remove the piece instead of commenting.</p><p><span>R: It is not in our old PQ and I see no reason to do this (probably an XCE thing). I would drop it.</span></p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">prune-vga-acpi-dev.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>removes vga from qemu device model (why?)</p><p>E: ASL descriptions only, removes \"NOP\" being returned for _S{1,2,3}D methods for VGA PCI device 0:2.0. Although the comment mentions cirrus in particular, I think this also applies to stdvga (currently default emulated device for QEMU in OpenXT). Ross knows better about ASL/AML. I think this avoid having the device from reporting it is not capable of D1, D2, D3, which prevents it from disabling S3 in a Windows guest.</p><p>R: This one is really weird - actually the code it removes is really weird. It is not clear what returning 0 for these even does does according to the spec. This needs further investigation but this is still in upstream. Maybe it does only effect Cirrus and it was some weird quirk for their driver. Tracked down original commit <ac:link ac:anchor=\"noteprunevga2\"><ac:plain-text-link-body><![CDATA[here]]></ac:plain-text-link-body></ac:link><a></a>, we should keep it.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen-libhvm.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>helper library for reading ACPI and SMBIOS firmware supporting passthrough</p><p>R: I wrote this library but we don't use it, XCE did. This is more of an issue when we move to the libxl toolstack and have to deal with guest firmware machinery that is currently in xenvm. I would drop the patch for now and deal with it later - there is a ticket for it: <ac:structured-macro ac:macro-id=\"d4f36a3e-ed15-4c0a-b175-95385d523489\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-505</ac:parameter></ac:structured-macro></p><p>Note: we are already using the hvmloader support for loading SMBIOS/ACPI bits into the guest. It is the toolstack side that needs work.</p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">smbios.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>add cache information (type 7) to the SMBIOS tables, as well as additional debug information</p><p>R: I checked and we used to add that type in via the old way we did smbios extra structure loading. We should probably keep it.</p></td></tr><tr><td colspan=\"1\">qemu-acpi-tables.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: I believe this is an XCE feature that used some back end bits in QEMU to get extra ACPI information. I am 99% sure we can just drop it, Eric can confirm the stuff isn't even in our QEMU.</p><p>E: I confirm, we do not have the 0x0510 and 0x0511 IO port in our QEMU.</p></td></tr><tr><td colspan=\"1\">acpi-no-hotplug.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>E: Remove instead of commenting.</p><p>R: A version of this was in our original pq. I wish I had some idea why we had to remove it. It is only used in the block of code in if (dm_version == QEMU_XEN_TRADITIONAL) so it doesn't really even make sense anymore.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">evtchn-do-not-set-pending-if-s3.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>properly handles event channels on suspended VMs. Plus, evtchn_set_pending was removed in commit (443701ef0c7ff30872e27419cf4356fb6bdb4059) in favor of evtchn_port_set_pending</p><p>R: We think it is needed but it also needs documentation about the fact that we don't know what it fixes.</p><p>M: <ac:structured-macro ac:macro-id=\"968e8376-9928-40ec-bd1e-a151aca44e56\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-578</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">hvmloader-vga-command-io.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">2c4f5125fd5e343604a620bc621848c4bd1e6080</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">vbe-lfb-addr-matches-hvmloader.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: Eric?</p><p>E: VGABIOS is built in its own repo and this is already in its patch-queue (<a href=\"https://github.com/eric-ch/xenclient-oe/blob/master/recipes-openxt/vgabios/vgabios-0.7a/vbe-hvmloader-lfb-addr.patch\">https://github.com/eric-ch/xenclient-oe/blob/master/recipes-openxt/vgabios/vgabios-0.7a/vbe-hvmloader-lfb-addr.patch</a>). Need documentation though, see <a class=\"issue-link\" href=\"https://openxt.atlassian.net/browse/OXT-545\" style=\"line-height: 1.42857;\">OXT-545</a>.</p></td></tr><tr><td colspan=\"1\">bios-uuid.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><div class=\"content-wrapper\"><p>adds functionality to set bios uuid (who uses this?)</p><p>R: Grepping xenclient-oe.git reveals it is used in a couple of our xt patches and is in our XSM policy.</p><p>xenclient-oe.git/recipes-extended/xen/files/gpt-iommu-mapping.patch<br/>xenclient-oe.git/recipes-extended/xen/files/xc-xt-aperture-map.patch<br/>xenclient-oe.git/recipes-extended/xen/files/xc-xt-set-servicevm.patch<br/>xsm-policy.git/policy/flask/access_vectors:# XEN_DOMCTL_setbiosuuid</p><p>We need it unless we manage to get rid of those patches.</p><p>M: All of the related patches have been drop. A ticket will be submitted for the changes to the XSM policy components.</p><p><ac:structured-macro ac:macro-id=\"fc9fa7e9-29c9-4a35-916e-9af4f1d1b783\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-584</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">bios-signature.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>adds the ability to obtain BIOS signatures (functionality relocated from apci_utils.x to build.c)</p><p>R: I guess that is reasonably useful but it won't work because we don't have the QEMU support (see <span>qemu-acpi-tables.patch). We are also currently setting the BIOS signatures to XenClient Enterprise <ac:emoticon ac:name=\"smile\"></ac:emoticon></span></p></td></tr><tr><td colspan=\"1\">crash_flag_hypercall.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>allows crash flag to be set</p><p>R: This is an XCE thing, HVMOP_set_crash_flag is not referenced anywhere in OpenXT. Drop it.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">hvm-rtc.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>E: For one, update the RTC when guest returns from PM state, that part should be important to keep RTC time consistent within guest. The second part about adjustment does not seem to bring much except sending QEMU the TIMEOFFSET IOREQ before updating the domain wallclock. There is a patch in QEMU to store diff for this guest in Xenstore to have it persistent accross reboots. Xen will be notified of this at QEMU's start through xc_domain_set_time_offset().</p><p>R: I think this patch is here because XCE used to use Xen to pause and resume guests and the clock would get scewed. I don't think this buys us anything because we do an actual guest S3 and wake. It needs more investigation though. It is possible we might see a need for it.</p><p>M:<ac:structured-macro ac:macro-id=\"d1aaa424-600f-4e78-b798-6275f7923c10\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-585</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">large-remap.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">R: This is the XCE batch mapper. It can go but <span>xc-xt-foreign-batch-cacheattr.patch will need to be rebased since bits of this patch appear in it.</span></td></tr><tr><td colspan=\"1\">dom0_auto_mem.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>E: was briefly mentioned in OXT-285. I do not think think is used or useful any more.</p><p>R: Yea that is an XCE thing we never used, drop it.</p></td></tr><tr><td colspan=\"1\">rombios-faster.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>removes floppy drive setup and other functionality</p><p>E: OpenXT uses SeaBIOS built separately. This can be ignored.</p></td></tr><tr><td colspan=\"1\">include-seabios.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>enables a seabios alternative</p><p>E: SeaBIOS is built separately. This can be ignored.</p></td></tr><tr><td colspan=\"1\">xc-xt-hvm-get-time.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>returns xen uptime</p><p>R: This one seems to only be used by the (possibly non-functional) audio-daemon PV userland backend. Maybe we can find a way to do this without a patch?</p><p>R: Posted to the mailing list. If we can remove the PV audio stuff, we can just check these patches in with the daemon and drop them here. See OXT-554</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">hvm-rtc-refresh-time.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>refresh time before it is set but time is set prior to function being called (race condition fix?)</p><p>E: refresh the current_tm each time rtc_set_time is called. I am not sure this is \"still\" required, current_tm is refreshed in the RTC IO port handler if the RTC is not in set mode and when disabling set mode. It could be a corner case though.</p><p>R: If there is a corner case here we should investigate it further, perhaps we drop it in the end.</p></td></tr><tr><td colspan=\"1\">reboot-quirk-pci.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">2bd6add4f5fa4ea2ba9297d6139e9dea42ea70a9</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xenstored-instrumentation.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>limits xenstore trace statements. can this patch be ignored?</p><p>E: Debug instrumentation, this can be ignored.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">acpi-pm-feature.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R: This is a valid patch that supports our in guest ACPI features for batteries etc. It goes with bit in QEMU and xcpmd and I just recently fixed and refacgtored it.</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-hvm-info.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>extends toolchain to display whether VT-x and VT-d are enabled</p><p>E: This should be reworked and xc_physinfo() could be used directly by the toolstack (which I believe is the only piece using this?)</p><p>M:<ac:structured-macro ac:macro-id=\"17708736-111e-4570-91aa-d385c2a8a355\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-586</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-xenconsoled-syslog.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>the changes to the create_domain_log, additions of safe_xs_read and name_from_dompath, add no additional functional with safe_xs_read tries=1</p><p>R: I think Eric was the original author of this though it had a lot of churn in our old PQ. Eric, what say you?</p><p>E: I was? We probably want to keep the syslog part (so long we want the guest console in the logger). I think \"renable_core_dumps()\" does not work and should not be done here.</p><p>M:<ac:structured-macro ac:macro-id=\"b14b2ef6-b38a-4b0e-8d17-188a3a2ba81b\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-587</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">xc-xt-ept-respect-cacheattr-pin.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">4d66f069d6abacd392f1301714fdfc64dc92917b</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xc-xt-interrupt-debug-info.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>adds additional debug functionality. can this patch be ignored?</p><p>E: Debug instrumentation, this can be ignored.</p></td></tr><tr><td colspan=\"1\">xc-xt-shadow-op-blow-tables.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: I don't know what this is. I don't see any references to xc_shadow_blow_tables anywhere in OpenXT. No meaningful comments in commit messages. It can probably go.</p><p>E: <a href=\"http://xen.markmail.org/thread/ahmyx2qath237hxd\">http://xen.markmail.org/thread/ahmyx2qath237hxd</a></p><p>R: Nothing reverence xc_shadow_blow_tables anywhere so I think this can go.</p></td></tr><tr><td colspan=\"1\">xc-xt-vcpu-get-time.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>is this functionality ever used?</p><p>R: This is also a hypercall that is only used by the audio-daemon. See xc-xt-hvm-get-time.patch above.</p><p><span>R: Posted to the mailing list. If we can remove the PV audio stuff, we can just check these patches in with the daemon and drop them here. See OXT-554</span></p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-tboot-shutdown-disable-irqs.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R: This one is mine. Disabling irqs too early causes an assert in debug builds. I believe this is valid and should be upstreamed too.</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-txt-shutdown-acpi-access-width.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>R: I tracked down the original commit for this and it is ugly. Seems it is for busted firmware on a Dell 980. I put the original commit message in the <ac:link ac:anchor=\"notetxtshutdown\"><ac:plain-text-link-body><![CDATA[Notes]]></ac:plain-text-link-body></ac:link> section below if we decide to keep this. I am leaning towards not keeping it.</p><p>R: We agreed this is a keeper because Dell 980's are still used. It needs to be renamed (with 980 i the name) and a comment added concerning the original issue documented below.</p><p>M: Renamed to \"xc-xt-Dell-980-txt-shutdown-acpi-access-width.patch\"</p><p>R: We can probably drop all the xc-xt- prefixes too - they don't really make any sense now.</p><p>M: I will do it when I am done. I created a JIRA ticket to remind myself.<ac:structured-macro ac:macro-id=\"a0efd7ce-d293-43ee-af4b-c819952ca23a\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-589</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-parse-video-from-mbi.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>passes framebuffer info over the multiboot structure (why?)</p><p>E: Get the MBI video info from the bootloader to Xen which will then pass it to dom0.</p><p>R: I remember this one and we need it so early boot graphics are happy.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-cpuid.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen | tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>R: This is actually two CPUID related patches mashed into one. The part about the XciVMMXciVMM signature was used by our old custom Linux PV drivers to get them to load instead of std pvops ones. This part can go away. The other part came from a patch called \"hvm-cpuid-multicore\" with an initial commit message:</p><p>\"Import hvm-cpuid-multicore patch from xenserver's patch queue.\"</p><p>and text from patch:</p><p>\"Expose vcpus as multiple cores in a smaller number of sockets, by adjusting the cpuid responses appropriately.\"</p><p>R: Eric remembered this was to allow us to make Windows think that VCPUs were cores not CPUs so we could overcome CPU count limits and licensing issues in Windows. I believe the addition op XEN_DOMCTL_setcorespersocket is what configures Xen to deal with the differences between cores and CPUs. I think we should keep this stuff.</p><p>M: Why is this marked as \"R\"?</p><p>R: I believe we decided to keep it but some parts of it (related to the <span>XciVMMXciVMM business) are not needed and should be removed. It is a patch with multiple earlier patches mashed in.</span></p><p><span>M:<ac:structured-macro ac:macro-id=\"995c28fb-3b75-46b0-a8df-ee88e33cf95c\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-590</ac:parameter></ac:structured-macro><br/></span></p></div></td></tr><tr><td colspan=\"1\">xc-xt-isa-irq-guest-binding.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">R: This one is a mystery - it is related to passing through a device with an ISA IRQ. I can't remember anything like that. Also 1/3 of the patch got lost when it was ported to the current patch queue (an important 1/3).</td></tr><tr><td colspan=\"1\">xc-xt-set-servicevm.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>adds service domain object to hypervisor|toolchain and XSM structures</p><p>R: Figured out where this came from. At some point XT had a requirement to allow service VMs to be able to access other guest's memory for VM introspection extension packs from 3rd parties. These operations are normally only something dom0 can do but this patch allows those operations in service VMs. This sounds dangerous to me TBH.</p></td></tr><tr><td colspan=\"1\">xc-xt-aperture-map.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">E: Formerly used with the XenGFX device, now defunct. Removal tracked under OXT-509.</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-xen-translate.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen | tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>translate guest psuedo-physical frame numbers (gpfn) to machine frame numbers (mfn) and XSM controls over the action (why?)</p><p>E: This is done so Surfman can manage framebuffer's mfn directly, as it used to registered those directly to the IGD using former IGFX plugin. This can probably be changed with some refactoring so surfman would use pfns directly considering the gem_foreign object behaviour.</p><p>M:<ac:structured-macro ac:macro-id=\"1ca7d3c5-9f08-45c8-ac12-04fa1c455531\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-591</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-local-pxe-rom.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>enables PXE booting (upstreamable?) and is this all that is needed?</p><p>E: Pass the IPXE ROM, that is built out of Xen tree, path to the build system so it can be embedded in hvmloader.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-v4v.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>adds v4v functionality</p><p>R: We want to keep this</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-v4v-viptables.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>adds v4v iptables-like functionality</p><p><span>R: We want to keep this</span></p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-unmap-shared-info.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">U</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>R: Eric and I agree this is legit. The original commit message talks about how this fixes guest S4 problems. Pasted commit message <ac:link ac:anchor=\"unmap-shared-info\"><ac:plain-text-link-body><![CDATA[here]]></ac:plain-text-link-body></ac:link>.</p><p>M: <ac:structured-macro ac:macro-id=\"925abd8f-2723-4665-8c68-25cb0a00ede0\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-593</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-foreign-batch-cacheattr.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R: This is for batch mapping and setting cache attrs during the map op. This is used by several things including xenfb2. It is a keeper. Note it will need to be rebased when we remove <span>large-remap.patch.</span></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-allow-pat-cacheattrs-for-all-domains.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>R: Tracked this one down, commit message:</p><p>\"framebuffer driver in uivm in XT relies on being able to set caching attributes on pages, through PAT.</p><p>But, the disallow mask for pv domains does not allow them unless the PV domain is using passthrough devices. Just allow them for all pv domains as well. We had existing patch for this in XT, but it was uglier as it manipulated the check call sites instead of disallow mask, as well as it had confusing name \"hvm_get_mem_pinned_cacheattr_always\"</p><p>So it seems to be needed ATM. Eric, thoughts?</p><p>E: Altough I am not entirely clear why, this is required. Trying without it will crash the platform quickly. I would have thought this was allowing xenfb2 in UIVM to change the cache-attributes of the framebuffer region. It needs more investigation.</p><p>M:<ac:structured-macro ac:macro-id=\"b69b3974-5585-4108-aff1-3e9485feebb8\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-594</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-opt-disable-vmcs-shadowing.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>R: Dug back in history on this one. This patch was introduced to turn of VMCS shadowing which was causing problems with nested virt. when we were trying to get Br's product to work on XenClient XT. Not sure what to do with it; Jed thinks we should drop it.</p><p>R: Needs more investigation; would not be needed where HW support for nested virt. was present.</p><p>M:<ac:structured-macro ac:macro-id=\"68933f59-04d4-429a-9351-a6c8a8372437\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-595</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">xc-xt-xenstore-use-pthread-always.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>forces pthread to be used all the time (comment claims that libxenstore does not work without it)</p><p>E: I misread this one. We used to have stub-domain programs linked statically. This became a problem with libxenstore as some program would assume to have libpthread linked (-DUSE_THREAD defined when libxenstore was built). This \"hack\" is no longer required anyway and Linux stub-domains no longer enforce static-linking.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xc-xt-hvmloader-legacy-seabios-optionroms.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p>E: Same as IPXE, pass the path where SeaBIOS is built to Xen's build system.</p><p>M: In Xen 4.6.1 seabios-dir is only built if SEABIOS_PATH is not specified. I believe the first hunk of this patch can be removed.<ac:structured-macro ac:macro-id=\"3c87a0f0-8844-4a3e-b4d0-b1724f549fc7\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-596</ac:parameter></ac:structured-macro></p></div></td></tr><tr><td colspan=\"1\">xc-xt-hvmloader-move-reservation-area.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: Looking at the history, it looks like we are just moving the top of hvmloader's reserved areas out of where we map the frame buffer. I say keep it. Eric, what do you think?</p><p>E: AFAICR this was used with gpt-superblanker to have those 16M of memory in the guest's e820 (for the superblanker). It is defunct.</p></td></tr><tr><td colspan=\"1\">xc-xt-tools-v3-mapspace-workaround.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>R: I remember this, it is a nasty one to deal with a problem in earlier versions of Windows tools that had the XENMAPSPACE_* values wrong. It is fixed in our current tools. This would only effect upgrades from XenClient XT 3.x to OpenXT and I don't even know if that is possible.</p><p>R: I checked and the upgrade path for existing customers involved removing old tools. So it should be fine to drop this hideous thing.</p></td></tr><tr><td colspan=\"1\">gpt-iommu-mapping.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">E: Defunct IGFX (and AMDplugin?) PVM logic. Add hypercalls to tweak IOMMU entries to redirect device DMA accesses to pages used by the guest (map_batch would have gfn→mfn, x_mapping would take gfns1 and gfns2, translate gfns2→mfns2 and do map_batch for gfns1→mfns2).</td></tr><tr><td colspan=\"1\">gpt-superblanker.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">E: Defunct IGFX/PVM. Reserve a 16M region in the e820 for the \"superblanker\". This was still conditioned to doing IGD pass-through, which the toolstack does not allow.</td></tr><tr><td colspan=\"1\">gpt-nvidia.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">E: quirk to load stdvga VGABIOS when passing through an NVIDIA card... Not sure why.</td></tr><tr><td colspan=\"1\">gpt-quiet-log.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">does-not-apply</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>can this patch be ignored?</p><p>E: I think it should, this log can be of use.</p></td></tr><tr><td colspan=\"1\">gpt-igd-hp-resume-workaround.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\"><p>specific to HP computers. can this patch be ignored?</p><p>R: IGFX code, not needed.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">gpt-s3-resume-reason.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><div class=\"content-wrapper\"><p><span>E: This does not seem pass-through related. Sets WAK_STS (although macro names it RSM_STS) and PWRBTN_STS in PM1a register. I do not think this is used, PM1 is currently emulated in QEMU and those bits will be set according to the logic implemented there. I can confirmed the QEMU emulation is called and PM1a R/W trap in QEMU. So HVM will get this register from QEMU. I think this should go. hvm-pm-s-state introduced an HVMOP to use that register, but I do not see much checking for those bits in Xen. So without the HVMOP, it's pretty much defunct.</span></p><p><span>R: Yea this is all coming back to me now. Xen intercepts IO to some of the register banks (PM1a STS and TMR) and others are mapped into QEMU (PM1a CNT and GPE0). I am going to mark this as refactor. I will work on fixing all this up and making sure everything matches between Xen, hvmloader and QEMU. Maybe we should start making tickets.</span></p><p><span>M:<ac:structured-macro ac:macro-id=\"6d169a33-1f6a-4f4a-8d1e-0e2039eb1aef\" ac:name=\"jira\" ac:schema-version=\"1\"><ac:parameter ac:name=\"server\">JIRA (openxt.atlassian.net)</ac:parameter><ac:parameter ac:name=\"serverId\">87e67eec-7c89-3635-99bf-e58e55630835</ac:parameter><ac:parameter ac:name=\"key\">OXT-598</ac:parameter></ac:structured-macro><br/></span></p></div></td></tr><tr><td colspan=\"1\">flask-bool-utility-fix.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">2e43e19fb3ca68b1a2a320d339a53c2007909f9b</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">flask-persist-booleans.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applies</td><td colspan=\"1\"> </td><td colspan=\"1\">D</td><td colspan=\"1\">R: This is built into a utility called flask-set-bool. I do not see this used anywhere in the project. Jed searched an entire build tree and it is not referenced anywhere. Also the path is references does not exist (\"/config/xsm/boolean/\"). Drop it.</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">cpufreq_gov_stop_avoid_panic.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>R: <span>I think this one looks legit and maybe should be upstreamed too. The original commit comment:</span></p><p><span>\"</span>Avoid panic in cpufreq_gov_stop</p><p>Looks like cpufreq_gov_stop is called without having a start first so this patch will check if the givernor has been enabled before disabling it.\"</p><p>R: Put a note in the patch comment that this may be able to be upstreamed. Machon will investigate further.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">fix-memcpy-in-x86-emulate.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>R: I think this one looks legit and maybe should be upstreamed too. See the original commit comment <ac:link ac:anchor=\"notefixmemcpy\"><ac:plain-text-link-body><![CDATA[here]]></ac:plain-text-link-body></ac:link>.</p><p>R: Put a note in the patch comment that this may be able to be upstreamed. Machon will investigate further, may be fixed upstream already.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">stubdomain-msi-irq-access.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">E: <span style=\"color: rgb(34,34,34);\">Allow QEMU running in a stubdom to do xc_physdev_map_pirq_msi(). </span><span style=\"color: rgb(34,34,34);\">PCI pass-through, with QEMU in a stub-domain, will surface the passed-through device in the </span><span style=\"color: rgb(34,34,34);\">stub-domain for config. space access. So QEMU will trap config. space access to </span><span style=\"color: rgb(34,34,34);\">set up MSI, and needs to xc_physdev_map_pirq_msi().</span></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">workaround-nehalem-igd-vtd.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>see patch comments</p><p>R: Keep it, it was accepted into OpenXT as a valid workaround.</p></td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen-x86-Fix-up-rules-when-forcing-mno-sse.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">applies</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"> </td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">R: I think that is perfectly valid, keep it.</td></tr><tr><td colspan=\"1\">xsa-125-long-latency-MMIO-mapping-operations-are-not-preemptible.patch</td><td colspan=\"1\">xen | tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:b10bca0483a1fa74de99807b89b13b27064794e1</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-127-certain-domctl-operations-may-be-abused-to-lock-up-the-host.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:83d1be544cbcd81720d2617f94976e851ce780dc</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-132-information-leak-through-XEN_DOMCTL_gettscinfo.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:a92efb747bbf256c20278517dfc179ced84bb869</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-134-GNTTABOP_swap_grant_ref-operation-misbehavior.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:5d5c09d853d3f212861f70c577c65d1703f752ae</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-136-vulnerability-in-the-iret-hypercall-handler.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:2ba368d13893402b2f1fb3c283ddcc714659dd9b</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-137-xl-command-line-config-handling-stack-overflow.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:dd84604f35bd3855c57146eb8fe53924c10d3963</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-142-libxl-fails-to-honour-readonly-flag-on-disks-with-qemu-xen.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:9204673fc60f606ec2b280a377e69d7fceedf5d6</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-148-uncontrolled-creation-of-large-page-mappings-by-PV-guests.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:fe360c90ea13f309ef78810f1a2b92f2ae3b30b8</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-149-leak-of-main-per-domain-vcpu-pointer-array.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:d46896ebbb23f3a9fef2eb6066ae614fd1acfd96</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-150-long-latency-populate-on-demand-operation-is-not-preemptible.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:101ce53266866144e724ed593173bc4098b300b9</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-151-leak-of-per-domain-profiling-related-vcpu-pointer-array.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:6e97c4b37386c2d09e09e9b5d5d232e37728b960</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-152-some-pmu-and-profiling-hypercalls-log-without-rate-limiting.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:95e7415843b94c346e5ba8682665f508f220e04b</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-153-populate-on-demand-balloon-size-inaccuracy-can-crash-guests.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:e294a0c3af9f4443dc692b180fb1771b1cb075e8</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-156-cpu-lockup-during-exception-delivery.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:bd2239d9fa975a1ee5bcd27c218ae042cd0a57bc</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xsa-155-paravirtualized-drivers-incautious-about-shared-memory-contents.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">tools</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\"><p>master:7d66a4ba695ab8d13b214fb816dd59e443ae1ec9</p><p>master:19f6c522a6a9599317ee1d8c4a155d1400d04c89</p><p>master:3f20b8def0f4c0d912f1ffc1893199b6e8820477</p></td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">needs to be ported</td></tr><tr><td colspan=\"1\">xsa-159-XENMEM_exchange-error-handling-issues.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:eedecb3cf0b2ce1ffc2eb08f3c73f88d42c382c9</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-160-libxl-leak-of-pv-kernel-and-initrd-on-error.patch</td><td colspan=\"1\">tools</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:f02ad357247901ad83e3910f3dadd70e231f3f3d</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-165-information-leak-in-legacy-x86-FPU-XMM-initialization.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:75904ac35f589b420d6d30415a64888b121d6484</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-166-ioreq-handling-possibly-susceptible-to-multiple-read-issue.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:b452430a4cdfc801fa4bc391aed7522365e1deb6</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-167-pv-superpage-functionality-missing-sanity-checks.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:b701ccc8ab35ff63bc4d613ec3c7bafec15aa0ee</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-168-intercept-issue-with-invlpg-on-non-canonical-address.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:828e114f7cdd9910483783ab0563b178325e579a</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td colspan=\"1\">xsa-169-unintentional-logging-upon-guest-changing-callback-method.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\">master:18eed42622b698e99f2950c293ae969ccaffe9ef</td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xsa-170-guest-user-mode-may-crash-guest-with-non-canonical-rip.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">master:ffbbfda37782a2408953af1a3e00ada80bb141bc</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">needs to be ported</td></tr><tr><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xsa-173-x86-shadow-pagetables-address-width-overflow.patch</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">xen</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">does-not-apply</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">master:8b17648339ba801c4c7937b5f13dd25068e54e60</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">K</td><td class=\"highlight-yellow\" colspan=\"1\" data-highlight-colour=\"yellow\">needs to be ported</td></tr><tr><td colspan=\"1\">xen-fix-xsave.patch</td><td colspan=\"1\">xen</td><td colspan=\"1\">applied</td><td colspan=\"1\"><p>master:e8121c54ec8cc6a92ae2d7219e7a7fede6dfd137</p></td><td colspan=\"1\">D</td><td colspan=\"1\">covered by up-rev to 4.6</td></tr></tbody></table><h2>Notes</h2><p>Notes to big to fit in the table...</p><h3><span><ac:structured-macro ac:macro-id=\"5fc96fa4-d7c9-4139-8ff3-89f8931321f9\" ac:name=\"anchor\" ac:schema-version=\"1\"><ac:parameter ac:name=\"\">notetxtshutdown</ac:parameter></ac:structured-macro>Note xc-xt-txt-shutdown-acpi-access-width</span></h3><p><span>This is the text from the original commit. I still think this is hacky but it is what Intel told us to do. This info should go in the patch header if we decide to keep it:</span></p><ac:structured-macro ac:macro-id=\"484e8e32-2286-4a87-8e3a-c96fb3297204\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[Fix Dell 980 platform shutdown with TXT\n    \n    From Joe:\n    \n    {quote}\n    OK, I've found the problem.\n    \n    The PM1a_CNT block on the Dell looks like:\n    [0ACh 0172  12]           PM1A Control Block : <Generic Address Structure>\n    [0ACh 0172   1]                     Space ID : 01 (SystemIO)\n    [0ADh 0173   1]                    Bit Width : 10\n    [0AEh 0174   1]                   Bit Offset : 00\n    [0AFh 0175   1]         Encoded Access Width : 01 (Byte Access:8)\n    [0B0h 0176   8]                      Address : 0000000000000804\n    \n    The access width is 1 (byte).  However, doing a single byte out causes the hang.  So Dell's ACPI table is incorrect.\n    \n    The reason this works for Xen w/o tboot is that Xen ignores the access width and always does a 16 bit outw--which works.  But according to one of our ACPI maintainers, the code really should respect the access width value.\n    \n    If I run Linux w/ tboot it appears that Linux is changing the access width value to 0 and that defaults to 16 bits--which works.\n    \n    At any rate, the following change to Xen fixes this and is essentially what Xen is doing internally:\n    static void tboot_sleep(u8 sleep_state)\n    {\n        uint32_t shutdown_type;\n    \n        tbg.space_id = g.space_id;          \\\n        tbg.bit_width = g.bit_width;        \\\n        tbg.bit_offset = g.bit_offset;      \\\n        tbg.access_width = g.access_width;  \\\n        tbg.address = g.address;\n    \n        /* sizes are not same (due to packing) so copy each one */\n        TB_COPY_GAS(g_tboot_shared->acpi_sinfo.pm1a_cnt_blk,\n                    acpi_sinfo.pm1a_cnt_blk);\n        g_tboot_shared->acpi_sinfo.pm1a_cnt_blk.access_width = 2;   <-------------- add this line...\n        TB_COPY_GAS(g_tboot_shared->acpi_sinfo.pm1b_cnt_blk,\n                    acpi_sinfo.pm1b_cnt_blk);\n        g_tboot_shared->acpi_sinfo.pm1b_cnt_blk.access_width = 2;   <-------------- and this line\n        TB_COPY_GAS(g_tboot_shared->acpi_sinfo.pm1a_evt_blk,\n                    acpi_sinfo.pm1a_evt_blk);\n        TB_COPY_GAS(g_tboot_shared->acpi_sinfo.pm1b_evt_blk,\n                    acpi_sinfo.pm1b_evt_blk);\n    {quote}\n]]></ac:plain-text-body></ac:structured-macro><h3><ac:structured-macro ac:macro-id=\"2301a9b4-26a9-434a-a111-04ef08c9891e\" ac:name=\"anchor\" ac:schema-version=\"1\"><ac:parameter ac:name=\"\">noteprunevga2</ac:parameter></ac:structured-macro>Note <span>prune-vga-acpi-dev</span></h3><p><span>This has been in Xen for ages. It looks like a \"fix\" to deal with some issues on XP and server 2003. I think we should keep this since the ASL that is removed doesn't look right and doesn't follow the spec. The commit message:</span></p><ac:structured-macro ac:macro-id=\"ae9cf34d-63b2-4d1f-b2bf-6b1ee565b436\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[commit 16d3c5de3c50b79296c288df876bec8b26d17d37\nAuthor: Keir Fraser <keir.fraser@citrix.com>\nDate:   Mon Dec 28 09:38:34 2009 +0000\n\n    hvmloader: Fix Windows XP standby with cirrus VGA\n    \n    Fix it by telling OSPM don't power down vga card on entering S3\n    state. The trick works for XP and Windows2003, but Vista still refuse\n    to allow S3.\n    \n    It is picked from kvm-userdapce.git commit 60e85d, author \"Gleb\n    Natapov\".\n    \n    Signed-off-by: Yu Ke <ke.yu@intel.com>]]></ac:plain-text-body></ac:structured-macro><h3><ac:structured-macro ac:macro-id=\"1c26e411-4e74-409c-af17-e3dc65ff6b82\" ac:name=\"anchor\" ac:schema-version=\"1\"><ac:parameter ac:name=\"\">notefixmemcpy</ac:parameter></ac:structured-macro>Note fix-memcpy-in-x86-emulate</h3><p>This is the commit message for this patch.</p><ac:structured-macro ac:macro-id=\"f216f5a9-d665-4c5b-8dfc-102618126894\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[    Make sure writebacks to guest memory are properly atomic\n    \n    When running x86_emulate, the code that writes the results back to guest\n    memory must ensure that the proper atomicity guaranteed by the instructions\n    being emulated is maintained. memcpy provides for atomic quadword writes\n    but writes the last 1-7 bytes using single byte operations (rep movsb) so\n    32- and 16- bit updates are not done atomically.\n    \n    This change uses specific atomnic operations if the size is 4 or 2 bytes.]]></ac:plain-text-body></ac:structured-macro><h3><ac:structured-macro ac:macro-id=\"ebc97cb1-8325-4a56-a7ab-5cd6390ca7cf\" ac:name=\"anchor\" ac:schema-version=\"1\"><ac:parameter ac:name=\"\">unmap-shared-info</ac:parameter></ac:structured-macro>Note <span>xc-xt-unmap-shared-info.patch</span></h3><ac:structured-macro ac:macro-id=\"25e697a3-4194-4f8d-b549-9d55b8f5614a\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[    XENMAPSPACE_shared_info can also unmmap the shinfo page\n    \n    When hibernating/resuming from disk HVM linux guests, there is the\n    situation where the booting domU linux kernel requests via a hypercall\n    its shared info page mapping but the just resumed from hibernation  kernel\n    has no idea what that page was and it may inadvertently use the old shared info\n    mapping - thinking it is a free page (when in fact is not).\n    \n    Therefore before freezing, the booting kernel has to restore(undo) its\n    shared info mapping so the hypercall involving XENMAPSPACE_shared_info\n    has now the ability to undo the operation if the xatp.gpfn field is\n    passed the \"magic\" value INVALID_MFN.]]></ac:plain-text-body></ac:structured-macro></ac:layout-cell></ac:layout-section><ac:layout-section ac:type=\"two_right_sidebar\"><ac:layout-cell><p><ac:structured-macro ac:macro-id=\"66ca5c3a-463b-42bb-8b76-07e7ee323a22\" ac:name=\"recently-updated\" ac:schema-version=\"1\"></ac:structured-macro></p></ac:layout-cell><ac:layout-cell><h2>Navigate space</h2><p><ac:structured-macro ac:macro-id=\"31b92281-e9f8-4d31-b526-d27fd9b4cd23\" ac:name=\"pagetreesearch\" ac:schema-version=\"1\"></ac:structured-macro></p><p><ac:structured-macro ac:macro-id=\"ad99c517-8034-4869-b1cf-d293b22b17f2\" ac:name=\"pagetree\" ac:schema-version=\"1\"></ac:structured-macro></p></ac:layout-cell></ac:layout-section></ac:layout>",
    "date": "2024-11-15",
    "disclaimer": "Users of this benchmark dataset are advised to check Atlassian’s official documentation for the most current information.",
    "space": "DC"
}