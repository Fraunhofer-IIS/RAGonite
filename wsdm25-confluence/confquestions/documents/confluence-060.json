{
    "id": "confluence-060",
    "title": "Forward Seal Test Procedures",
    "url": "https://openxt.atlassian.net/wiki/spaces/TEST/pages/76910241/Forward+Seal+Test+Procedures",
    "content": "<p>Owned by Daniel Smith\nLast updated: Jun 27, 2017 by Daniel Smith\n\n</p><h2>Objective:</h2><p>To successfully upgrade an OpenXT system whereby the system calculates the seal measurements for the next boot and uses those to seal the system, a.k.a. forward seal.</p><h2>Preconditions:</h2><ol><li>OpenXT Stable-6 configured for Measured Launch</li><li>OpenXT Stable-7 packages-main hosted on web server accessible by DUT.</li></ol><h2>Artifacts:</h2><table class=\"wrapped\"><colgroup><col/><col/></colgroup><tbody><tr><th>Artifact</th><th>Explanation</th></tr><tr><td><p>Forward Seal Record:</p><p>/boot/system/tpm/forward_pcr.lst</p></td><td>This file contains a list of PCRs the foward seal operation sealed to, including any predicted values.</td></tr><tr><td><p>Failed ML PCR State:</p><p>/boot/system/tpm/bad.pcrs</p></td><td>This file contains a list of the PCRs at the time that the unseal operation was attempted. In the situation where the unseal failed after a OTA upgrade, this file can be compared with the \"Forward Seal Record\" to verify whether the predicted PCRs matched dynamic PCRs (15,17,18,19).</td></tr><tr><td><p>Known Good PCR State:</p><p>/config/good.pcrs</p></td><td>This file contains a list of the PCRs at the last \"known good\" state of the system. Anytime a ML fails, this file can be compared with the \"Failed ML PCR State\" to verify/compare both static and dynamic PCRs.</td></tr><tr><td colspan=\"1\"><p>Platform Sealing Utility:</p><p>/usr/sbin/seal-system</p></td><td colspan=\"1\">This utility can be used to seal to the current state or to a predicted state. For troubleshooting and/or testing purposes, it is possible to forward seal to the current state by invoking seal-system -f on an existing system.</td></tr></tbody></table><h2>Procedures:</h2><h3>Successful Seal</h3><table class=\"fixed-table wrapped\"><colgroup><col style=\"width: 569.0px;\"/><col style=\"width: 656.0px;\"/></colgroup><tbody><tr><th>Step</th><th>Expected Result</th></tr><tr><td><ol><li>Enter UIVM graphical display using key sequence Ctrl-0 if not already at that screen</li></ol></td><td>Will be presented with UIVM graphical display</td></tr><tr><td><p>2. Click \"Settings\" button on the toolbar at the top of the screen</p></td><td>The \"Settings\" dialog box will appear</td></tr><tr><td>3. Click \"Software Update\" from menu list on left hand side of \"Settings\" dialogue box</td><td>The right hand side of \"Settings\" dialogue will be display the \"Update Software\" form</td></tr><tr><td colspan=\"1\">4. In the text field under \"Update Software\" enter the URL path that contains the packages-main folder on the web server</td><td colspan=\"1\">The text field will contain the URL path without an ending path separator, \"/\"</td></tr><tr><td colspan=\"1\">5. Click the \"Check for Update\" button</td><td colspan=\"1\">A confirmation dialogue box will be presented informing that an update is available for download</td></tr><tr><td colspan=\"1\">6. Click the \"Download\" button within the confirmation dialogue box that was presented</td><td colspan=\"1\"><ul><li>The text field will be replaced with a progress bar that reflects download progress.</li><li>Upon download completion, a notification box will appear.</li></ul></td></tr><tr><td colspan=\"1\">7. Click \"Okay\" button within the notification box that was presented</td><td colspan=\"1\">The notification box will disappear</td></tr><tr><td colspan=\"1\">8. Click \"Power\" button on the toolbar at the top of the screen</td><td colspan=\"1\">A drop-down list will be presented</td></tr><tr><td colspan=\"1\">9. Click the \"Restart\" list item from the drop-down list that was presented</td><td colspan=\"1\"><ul><li>The UIVM graphical display will disappear and an OpenXT splash screen will be present that has a status of \"Upgrading\"</li><li>The OpenXT splash screen will eventually disappear</li><li>The system will reboot</li><li>The system will boot to its normal state, the UIVM graphical display unless there are guest configured to auto start.</li></ul></td></tr></tbody></table><h3 class=\"auto-cursor-target\">OTA Upgrade Tamper Detection</h3><table class=\"fixed-table wrapped\"><colgroup><col style=\"width: 567.0px;\"/><col style=\"width: 656.0px;\"/></colgroup><tbody><tr><th>Step</th><th>Expected Result</th></tr><tr><td><ol><li>Enter UIVM graphical display using key sequence Ctrl-0 if not already at that screen</li></ol></td><td>Will be presented with UIVM graphical display</td></tr><tr><td><p>2. Click \"Settings\" button on the toolbar at the top of the screen</p></td><td>The \"Settings\" dialog box will appear</td></tr><tr><td>3. Click \"Software Update\" from menu list on left hand side of \"Settings\" dialogue box</td><td>The right hand side of \"Settings\" dialogue will be display the \"Update Software\" form</td></tr><tr><td>4. In the text field under \"Update Software\" enter the URL path that contains the packages-main folder on the web server</td><td>The text field will contain the URL path without an ending path separator, \"/\"</td></tr><tr><td>5. Click the \"Check for Update\" button</td><td>A confirmation dialogue box will be presented informing that an update is available for download</td></tr><tr><td>6. Click the \"Download\" button within the confirmation dialogue box that was presented</td><td><ul><li>The text field will be replaced with a progress bar that reflects download progress.</li><li>Upon download completion, a notification box will appear.</li></ul></td></tr><tr><td>7. Click \"Okay\" button within the notification box that was presented</td><td>The notification box will disappear</td></tr><tr><td>8. Click \"Power\" button on the toolbar at the top of the screen</td><td>A drop-down list will be presented</td></tr><tr><td>9. Click the \"Restart\" list item from the drop-down list that was presented</td><td><ul><li>The UIVM graphical display will disappear and an OpenXT splash screen will be present that has a status of</li><li>\"Upgrading\". The OpenXT splash screen will eventually disappear</li><li>The system will begin to shutdown</li></ul></td></tr><tr><td>10. When BIOS/Firmware boot splash appears, interrupt the boot and power the SUT off</td><td>The SUT will be powered off</td></tr><tr><td>11. Boot the device using a bootable USB stick with an OpenXT ISO image</td><td>The \"Welcome to OpenXT\" screen will be presented</td></tr><tr><td>12. Press Alt+F3</td><td>A shell login screen will be presented</td></tr><tr><td>13. Enter \"root\" as the user name and press the enter key</td><td>A shell prompt will be presented</td></tr><tr><td>14. Run the command \"vgscan\"</td><td><p>Should receive the message, \"Found volume group \"xenclient\" using metadata type lvm2\"</p></td></tr><tr><td>15. Run the command \"vgchange -ay\"</td><td>Should receive the message, \"8 logical volume(s) in volume group \"xenclient\" now active\"</td></tr><tr><td>16. Run the command \"mount /dev/xenclient/root /mnt\"</td><td>If successful, no messages will be received</td></tr><tr><td>17. Run the command \"ls -l /mnt/sbin/init.root-ro\"</td><td>The file listing details should be presented, make note of the date/time stamp</td></tr><tr><td>18. Run the command \"touch /mnt/sbin/init.root-ro\"</td><td><span>If successful, no messages will be received</span></td></tr><tr><td>19. Run the command \"ls -l /mnt/sbin/init.root-ro\"</td><td>The file listing details should be presented. Compare the date/time stamp with the result from (17), they should be different</td></tr><tr><td colspan=\"1\">20. Run the command \"umount /mnt\"</td><td colspan=\"1\"><span>If successful, no messages will be received</span></td></tr><tr><td colspan=\"1\">21. Run the command \"poweroff\"</td><td colspan=\"1\">The SUT should power off</td></tr><tr><td colspan=\"1\">22. Remove the USB stick from the system</td><td colspan=\"1\">The SUT will be in its normal boot configuration with respect to external devices connected</td></tr><tr><td colspan=\"1\">23. Power on the SUT</td><td colspan=\"1\"><ul><li>The SUT will begin to boot</li><li>The warning dialogue, \"SECURITY WARNING: TXT measured boot FAILED\", will appear</li></ul></td></tr></tbody></table><p><br/></p><ac:structured-macro ac:macro-id=\"c6dc02bc-efa3-42d4-8533-a746454a0eb6\" ac:name=\"info\" ac:schema-version=\"1\"><ac:parameter ac:name=\"icon\">None</ac:parameter><ac:rich-text-body><p><ac:image ac:width=\"80\"><ri:attachment ri:filename=\"cc-by.png\" ri:version-at-save=\"1\"><ri:page ri:content-title=\"Documentation Guidelines\" ri:space-key=\"OD\" ri:version-at-save=\"12\"></ri:page></ri:attachment></ac:image><br/> Copyright 2017 by Apertus Solutions, LLC. Created by Daniel P. Smith. This work is licensed under the Creative Commons Attribution 4.0 International License. To view a copy of this license, visit <a class=\"external-link\" href=\"http://creativecommons.org/licenses/by/4.0/\" rel=\"nofollow\">http://creativecommons.org/licenses/by/4.0/</a>.</p></ac:rich-text-body></ac:structured-macro><p class=\"auto-cursor-target\"><br/></p><p>Author: MagOXT Date: 2017-06-28T17:58:20.178Z Comment: Test caseOpenXT with ML broken before upgrade (red shield)Perform OTA upgradeThe system forward seal. ML is up after upgrade without entering password.QuestionIf a hardware is used without being sealed, why does the upgrade seal it?JIRA (openxt.atlassian.net)key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution87e67eec-7c89-3635-99bf-e58e55630835OXT-1167</p>",
    "date": "2024-11-15",
    "disclaimer": "Users of this benchmark dataset are advised to check Atlassianâ€™s official documentation for the most current information.",
    "space": "TEST"
}