{
    "id": "confluence-134",
    "title": "TPM PCRS Values",
    "url": "https://openxt.atlassian.net/wiki/spaces/TEST/pages/30408724/TPM+PCRS+Values",
    "content": "<p>Owned by Marc Aylesworth\nLast updated: Apr 01, 2016 by Marc Aylesworth\n\n</p><p> These are the steps for validating values that are in the Trusted Platform Module (TPM) <span class=\"st\">Platform Configuration Registers</span> (PCRS).</p><p>The TPM module can:</p><ul><li>Generate cryptographic keys</li><li>Generate random numbers</li><li><em>Remote attestation</em> – creates a nearly unforgeable hash key summary of the hardware and software configuration. The program hashing the configuration data determines the extent of the summary of the software. This allows a third party to verify that the software has not been changed.</li><li><em>Binding</em> – encrypts data using TPM bind key, a unique <a class=\"mw-redirect\" href=\"https://en.wikipedia.org/wiki/RSA_%28algorithm%29\" title=\"RSA (algorithm)\">RSA</a> key descended from a storage key<sup> </sup></li><li><em>Sealing</em> – encrypts data in a similar manner to binding, but in addition specifies a state in which TPM must be in order for the data to be decrypted (unsealed)<sup> <br/></sup></li></ul><h3><sup>For more information on the TPM:</sup><sup class=\"reference\"><a href=\"https://en.wikipedia.org/wiki/Trusted_Platform_Module\">    TPM Wikipedia article</a><br/></sup></h3><p>The TPM also has special registers (called <span class=\"new\">Platform Configuration Registers</span> – PCRs) which hold various measurements in a shielded location in a manner that prevents spoofing. Measurements consist of a cryptographic hash using a Secure Hashing Algorithm (SHA); the TPM v1.0 specification uses the SHA-1 hashing algorithm. More recent TPM versions (v2.0+) call for SHA-2.</p><p>The PCRs that OpenXT looks at for the Measured launch are PCRs 0-3 and PCRs 17 - 19 these PCRs hold the information in the following list.</p><ul><li><em>PCR0 – CRTM</em>, BIOS code, and Host Platform Extensions<sup> </sup></li><li><p><em>PCR1</em> – Host Platform Configuration</p></li><li><em>PCR2</em> – Option ROM Code</li><li><em>PCR3</em> – Option ROM Configuration and Data</li><li><em>PCR17</em> – DRTM and launch control policy</li><li><em>PCR18</em> – Trusted OS start-up code (MLE)</li><li><em>PCR19</em> – Trusted OS (for example OS configuration)</li></ul><h6>For more information on the PCRs<a href=\"https://en.wikipedia.org/wiki/Trusted_Execution_Technology\">:     Trusted Execution use of PCRs Wikipedia article</a></h6><h2>Where are these values in OpenXT</h2><p>These values can be found in a 3.x kernel based build in /sys/class/misc/tpm0/device/pcrs and in a 4.x kernel in /sys/class/tpm/tpm0/device/pcrs.</p><p>I you display the contents of the pcrs file you will get a grid of hex values in a format similar to this:</p><pre> </pre><p>PCR-00: 88 D5 D8 5F 9A F6 A3 13 46 F6 B1 00 BE 73 76 F9 81 38 F4 7C</p><p>PCR-01: 72 DE 4D E4 EE 7D 75 03 07 D8 E0 DC C1 9C 42 B9 B4 BD A8 5C</p><p>PCR-02: B2 6E 23 89 08 9A 44 E3 47 1B 01 33 BD 16 54 68 D5 30 21 75</p><p>PCR-03: 3A 3F 78 0F 11 A4 B4 99 69 FC AA 80 CD 6E 39 57 C3 3B 22 75</p><p>PCR-04: C4 88 7E 3B 3C 29 E0 72 7D 34 46 56 26 AC 5D 64 5B 53 47 94</p><p>PCR-05: DA 69 6B 3E C0 09 8A 73 B2 25 79 FF EB 70 E3 CB 79 CE 4B D5</p><p>PCR-06: 78 CD 77 59 86 6A 77 D0 31 03 C2 03 5B F7 DC 7E 61 DC 19 2E</p><p>PCR-07: 3A 3F 78 0F 11 A4 B4 99 69 FC AA 80 CD 6E 39 57 C3 3B 22 75</p><p>PCR-08: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-09: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-11: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-12: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-13: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-14: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-15: BE 21 1D 90 92 53 01 7B D7 0E D8 6A A2 05 04 8B 85 10 C7 B6</p><p>PCR-16: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-17: 19 F0 41 EA 40 26 00 E0 22 E6 96 0A 1E 56 09 A6 AE 86 73 D2</p><p>PCR-18: D7 51 E8 5C 6D AC 4A 91 80 14 F2 9F 03 75 02 5D C9 A4 E4 F1</p><p>PCR-19: FB 9D DA 4D 0C D9 0B 3C 33 6F 59 DE B8 64 5E 82 15 A2 B5 27</p><p>PCR-20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-21: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-22: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p>PCR-23: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</p><p> Notice the values in row PCR 0-3 an PCR 17-19 are unique and should <span class=\"spell\"> </span> be consistent between reboots with no change to <span class=\"spell\"><em>the computer configuration</em></span></p><p> </p><p>Things that should trigger a reseal for a measured launch:</p><ul><li>change to BIOS settings</li><li>Internal changes to hardware( add graphics card ...)</li><li>Changes to configuration files </li></ul><p>Things that should not trigger a reseal for a measured launch:</p><ul><li>External change to hardware( Plugin a USB drive)</li><li>Change of screen brightness</li><li>removing laptop from docking station</li><li>adding removing keyboard and mouse</li></ul><p> </p><p>Access to a command prompt can be gained in a number of ways:</p><ol><li>medic, The install medic option will bring you to a command prompt</li><li>from the installer press &lt;ctrl&gt;&lt;alt&gt; &lt;F3&gt;</li><li>Press &lt;ctrl&gt;&lt;shift&gt;t</li></ol><p>From a command prompt type  more /sys/class/misc/tpm0/device/pcrs for a 3.x kernel device and</p><p>more /sys/class/tpm/tpm0/device/pcrs for a 4.x kernel device</p><p> </p><ac:structured-macro ac:macro-id=\"99f3057d-d5e7-46b8-8e3e-def51ba9869c\" ac:name=\"details\" ac:schema-version=\"1\"><ac:parameter ac:name=\"hidden\">true</ac:parameter><ac:rich-text-body><p> </p></ac:rich-text-body></ac:structured-macro>",
    "date": "2024-11-15",
    "disclaimer": "Users of this benchmark dataset are advised to check Atlassian’s official documentation for the most current information.",
    "space": "TEST"
}