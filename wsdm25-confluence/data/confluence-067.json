{
    "id": "confluence-067",
    "title": "TPM 2.0",
    "url": "https://openxt.atlassian.net/wiki/spaces/DC/pages/77302339/TPM+2.0",
    "content": "<p>Owned by Chris Rogers\nLast updated: Jul 12, 2017 by Chris Rogers\n\n</p><p><br/></p><p>OpenXT now supports TPM 2.0 hardware for Measured Launch.  The following page will serve as a reference for developers seeking to work with TPM 2.0 within OpenXT.</p><h2>Sealing</h2><p>In order to verify platform integrity and protect the config partition private key, we use the TPM to seal the key against a set of PCRs <em>P</em> {0,1,2,3,4,15,17,18,19}.  OpenXT does this by doing the following steps.</p><p>At install time:<br/>1) Take ownership of the TPM for all hierarchies<br/>2) Call tpm2_createprimary with the <em>Owner</em> hierarchy to derive a primary context from the <em>Owner</em> seed.<br/>3) Call tpm2_evictcontrol on the context created in step 2 to convert it from a <em>transient</em> handle to a <em>persistent</em> handle<br/>On First Boot:<br/>4) Call tpm2_sealdata with the /config partition key as input, sealing against the above mentioned PCRs while the platform is in a known good state <em>S</em>.</p><p>After Upgrades:<br/>4a) Precompute the values for a subset of <em>P,</em> (we'll call this set <em>P') </em> where <em>P'</em> is defined as PCRs {15, 17, 18, 19} for the next platform boot.<br/>4b) Call tpm2_sealdata with these pre-computed values.</p><h2>Unsealing</h2><p>On Boot:<br/>1) Call tpm2_unsealdata to retrieve the private key used to decrypt the /config partition.  The key will only unseal if the PCRs are in state <em>S</em>.</p><p><br/></p><p>WIP...</p><h2>Xen Summit 2017 slides</h2><p><ac:structured-macro ac:macro-id=\"53736243-00b1-4601-b9dd-217a88c472cf\" ac:name=\"view-file\" ac:schema-version=\"1\"><ac:parameter ac:name=\"name\"><ri:attachment ri:filename=\"TPM 2.0 OpenXT v3.pdf\" ri:version-at-save=\"1\"><ri:content-entity ri:content-id=\"77302339\" ri:version-at-save=\"1\"></ri:content-entity></ri:attachment></ac:parameter><ac:parameter ac:name=\"height\">250</ac:parameter></ac:structured-macro></p>",
    "date": "2024-11-15",
    "disclaimer": "Users of this benchmark dataset are advised to check Atlassian’s official documentation for the most current information.",
    "space": "DC"
}