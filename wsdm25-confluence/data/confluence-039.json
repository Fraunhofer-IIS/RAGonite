{
    "id": "confluence-039",
    "title": "Smart Card Testing",
    "url": "https://openxt.atlassian.net/wiki/spaces/TEST/pages/17793040/Smart+Card+Testing",
    "content": "<p>Owned by Ross Philipson\nLast updated: Nov 10, 2015 by Ross Philipson\n\n</p><ac:structured-macro ac:macro-id=\"2bb73bc7-4128-44a2-bdcd-2c2c0fb49f26\" ac:name=\"info\" ac:schema-version=\"1\"><ac:parameter ac:name=\"icon\">None</ac:parameter><ac:rich-text-body><p><ac:image ac:width=\"80\"><ri:attachment ri:filename=\"cc-by.png\"><ri:page ri:content-title=\"Documentation Guidelines\" ri:space-key=\"OD\"></ri:page></ri:attachment></ac:image></p><p>Copyright 2015 by Assured Information Security, Inc. Created by Ross Philipson &lt;philipsonr@ainfosec.com&gt;. This work is licensed under the Creative Commons Attribution 4.0 International License. To view a copy of this license, visit <a class=\"external-link\" href=\"http://creativecommons.org/licenses/by/4.0/\" rel=\"nofollow\">http://creativecommons.org/licenses/by/4.0/</a>.</p></ac:rich-text-body></ac:structured-macro><p><ac:structured-macro ac:macro-id=\"9adc631d-336d-4a1c-a324-1e3da8cd16d8\" ac:name=\"toc\" ac:schema-version=\"1\"></ac:structured-macro></p><h2>PIVKey</h2><p>The PIVKey smart card home is here:</p><p><a href=\"http://pivkey.com/\">http://pivkey.com/</a></p><p>They follow the PIV standard found here:</p><p><a href=\"http://www.smartcardalliance.org/publications-a-comparison-of-piv-piv-i-and-civ-credentials/\">http://www.smartcardalliance.org/publications-a-comparison-of-piv-piv-i-and-civ-credentials/</a></p><p>And they can be easily purchased, e.g. from here:</p><p><a href=\"http://www.amazon.com/gp/product/B00SJV2CNK?psc=1&amp;redirect=true&amp;ref_=oh_aui_detailpage_o02_s00\">http://www.amazon.com/gp/product/B00SJV2CNK?psc=1&amp;redirect=true&amp;ref_=oh_aui_detailpage_o02_s00</a></p><p>The documentation can be found here:</p><p><a href=\"https://pivkey.zendesk.com/hc/en-us/categories/200284639-Technical-Support\">https://pivkey.zendesk.com/hc/en-us/categories/200284639-Technical-Support</a></p><p><span style=\"color: rgb(85,85,85);\"><span style=\"color: rgb(85,85,85);\">PIVKeys are an alternative to CAC cards for testing smart card readers. </span>By default the PIVKey is loaded with a Certificate for Card Authentication. The first thing that has to be done is to setup a proper PIN for the card. The instructions here detail that step:</span></p><p><span style=\"color: rgb(85,85,85);\"><a href=\"https://pivkey.zendesk.com/hc/en-us/articles/203126729-Getting-Started-with-PIVKey-Management\">https://pivkey.zendesk.com/hc/en-us/articles/203126729-Getting-Started-with-PIVKey-Management</a></span></p><p><span style=\"color: rgb(85,85,85);\">Also there are instructions for PIV certificate mapping:</span></p><p><a href=\"https://pivkey.zendesk.com/hc/en-us/articles/203862405-PIV-Certificate-Mapping\">https://pivkey.zendesk.com/hc/en-us/articles/203862405-PIV-Certificate-Mapping</a></p><p><span style=\"color: rgb(85,85,85);\"> There is a step for Default Certificate Mapping but this seems to be unnecessary (it is already done) and this mapping type seems sufficient. At this point the card is ready to use.</span></p><h2><span style=\"color: rgb(85,85,85);\">PIVKey on Linux</span></h2><p>To start with, a few packages need to be installed. This is an example on Debian but similar packages on most distros should exist. This installs the <span style=\"color: rgb(85,85,85);\">PCSCLite packages <span style=\"color: rgb(85,85,85);\">for support of CCID compatible readers and tokens which PIVKey is one.</span></span></p><ac:structured-macro ac:macro-id=\"43646379-d021-4d9d-95f1-d72322229963\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[$ sudo apt-get install libpcsclite1\n$ sudo apt-get install libpcsclite-dev\n$ sudo apt-get install pcscd\n$ sudo apt-get install pcsc-tools]]></ac:plain-text-body></ac:structured-macro><p>The OpenSC packages are also needed:</p><ac:structured-macro ac:macro-id=\"364e6aa7-4519-487d-a67e-1c87e586b096\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[$ sudo apt-get install opensc]]></ac:plain-text-body></ac:structured-macro><p>The main instructions are here:</p><p><a href=\"https://pivkey.zendesk.com/hc/en-us/articles/203578629-PIVKey-on-Linux\">https://pivkey.zendesk.com/hc/en-us/articles/203578629-PIVKey-on-Linux</a></p><p>A few notes on the instructions:</p><p>Updating <span style=\"color: rgb(85,85,85);\"><code>/usr/lib/pcsc/drivers/ifd-ccid.bundle/Contents/Info.plist</code> did not solve all of the problems <code>pcsc_scan</code> had in recognizing the card. The following step makes it happy:</span></p><ac:structured-macro ac:macro-id=\"65931582-0c1a-4f45-9242-7604426abdb1\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[$ wget http://ludovic.rousseau.free.fr/softwares/pcsc-tools/smartcard_list.txt --output-document=/home/<your-user>/.cache/smartcard_list.txt]]></ac:plain-text-body></ac:structured-macro><p><span style=\"color: rgb(85,85,85);\">Follow the instructions closely for editing <span style=\"color: rgb(85,85,85);\"><code>/etc/opensc/opensc.conf</code>.</span></span></p><p><span style=\"color: rgb(85,85,85);\"><span style=\"color: rgb(85,85,85);\">The location of the library to use in Firefox/Iceweasel is the same on Debian.</span></span></p><p><span style=\"color: rgb(85,85,85);\">Things are working correctly if the following commands are properly displaying the ATR:</span></p><ac:structured-macro ac:macro-id=\"55a3221d-94d8-4b17-b97c-6d9432261f7e\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[$ pcsc_scan\n$ opensc-tool -a\n$ piv-tool -c piv --serial]]></ac:plain-text-body></ac:structured-macro><p><span style=\"color: rgb(85,85,85);\">Finally and most importantly, that the PIVKey test website is allowing the PIN based login and then displaying the test results and certificate information correctly:</span></p><p><span style=\"color: rgb(85,85,85);\"><a href=\"https://pivkey.com:448/\">https://pivkey.com:448</a></span></p><h3>PCSC Middleware</h3><p>The PCSC packages provide the drivers and middle-ware to allow clients to talk to the smart card device. The drivers are shared libraries in user land and most smart card readers can use <code>libccid</code>. This driver in turn talks to USB devices using <code>libusb</code>. The driver library (or libraries) are loaded by the <code>pcscd</code> daemon. Clients (like the PCSC tools) talk to the daemon to access the cards.</p><h2><span style=\"color: rgb(85,85,85);\">PIVKey on Windows</span></h2><p><span style=\"color: rgb(85,85,85);\">The first thing to do is to insure the PV USB and Smart Card drivers have loaded correctly. Follow these instructions for this (note PV USB will also create host controller and root hub devices):</span></p><p><span style=\"color: rgb(85,85,85);\"><a href=\"https://pivkey.zendesk.com/hc/en-us/articles/203775049-Testing-the-PIVKey-on-the-User-PC\">https://pivkey.zendesk.com/hc/en-us/articles/203775049-Testing-the-PIVKey-on-the-User-PC</a></span></p><p><span style=\"color: rgb(85,85,85);\">Next install the PIVKey Windows software:</span></p><p><span style=\"color: rgb(85,85,85);\"><a href=\"https://pivkey.zendesk.com/hc/en-us/articles/203126279-Installing-the-PIVKey-Administrator-Tools\">https://pivkey.zendesk.com/hc/en-us/articles/203126279-Installing-the-PIVKey-Administrator-Tools</a></span></p><p><span style=\"color: rgb(85,85,85);\">Once installed, these commands should show information about the card:</span></p><ac:structured-macro ac:macro-id=\"d98d4d72-d9cb-4594-b098-f4fd1d53ebdb\" ac:name=\"code\" ac:schema-version=\"1\"><ac:parameter ac:name=\"language\">text</ac:parameter><ac:plain-text-body><![CDATA[C:\\Program Files\\PIVKey Administrator\\PIVKey Admin Tools\\PivKeyTool.exe --listcardid\nC:\\Program Files\\PIVKey Administrator\\PIVKey Admin Tools\\PivKeyTool.exe --listmd\nC:\\Program Files\\PIVKey Administrator\\PIVKey Admin Tools\\PivKeyTool.exe --listpiv ]]></ac:plain-text-body></ac:structured-macro><p><span style=\"color: rgb(85,85,85);\">Finally and most importantly, that the PIVKey test website is allowing the PIN based login and then displaying the test results and certificate information correctly:</span></p><p><span style=\"color: rgb(85,85,85);\"> </span><a href=\"https://pivkey.com:448/\" style=\"line-height: 1.42857;\">https://pivkey.com:448</a></p><p><span style=\"color: rgb(85,85,85);\"><br/></span></p>",
    "date": "2024-11-15",
    "disclaimer": "Users of this benchmark dataset are advised to check Atlassian’s official documentation for the most current information.",
    "space": "TEST"
}